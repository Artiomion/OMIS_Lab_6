{% extends "base.html" %}

{% block title %}–ú–æ–∏ –≤–∞–∫–∞–Ω—Å–∏–∏{% endblock %}

{% block content %}
<h2>üíº –ú–æ–∏ –≤–∞–∫–∞–Ω—Å–∏–∏</h2>

<a href="{{ url_for('vacancy.create') }}" class="button" style="margin-bottom: 2rem;">‚ûï –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –≤–∞–∫–∞–Ω—Å–∏—é</a>

{% if vacancies %}
    {% for vacancy in vacancies %}
    <div class="card">
        <h3>{{ vacancy.title }}</h3>
        <p><span class="badge {{ vacancy.status }}">{{ vacancy.status }}</span></p>
        <p>{{ vacancy.description[:200] }}{% if vacancy.description|length > 200 %}...{% endif %}</p>
        
        <p><strong>–û—Ç–∫–ª–∏–∫–æ–≤:</strong> {{ vacancy.applications.count() }}</p>
        <p style="color: #6c757d; font-size: 0.9rem;">–°–æ–∑–¥–∞–Ω–æ: {{ vacancy.created_at.strftime('%d.%m.%Y') }}</p>
        
        <div style="margin-top: 1rem;">
            <a href="{{ url_for('vacancy.view', vacancy_id=vacancy.id) }}" class="button">–ü—Ä–æ—Å–º–æ—Ç—Ä</a>
            <a href="{{ url_for('vacancy.edit', vacancy_id=vacancy.id) }}" class="button secondary">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
            <a href="{{ url_for('vacancy.applications', vacancy_id=vacancy.id) }}" class="button secondary">
                –û—Ç–∫–ª–∏–∫–∏ ({{ vacancy.applications.count() }})
            </a>
            
            {% if vacancy.status == 'draft' %}
                <form method="POST" action="{{ url_for('vacancy.publish', vacancy_id=vacancy.id) }}" style="display: inline;">
                    <button type="submit" class="button success">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å</button>
                </form>
            {% elif vacancy.status == 'published' %}
                <form method="POST" action="{{ url_for('vacancy.close', vacancy_id=vacancy.id) }}" style="display: inline;">
                    <button type="submit" class="button danger">–ó–∞–∫—Ä—ã—Ç—å</button>
                </form>
            {% endif %}
            
            <form method="POST" action="{{ url_for('vacancy.delete', vacancy_id=vacancy.id) }}" style="display: inline;" 
                  onsubmit="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É –≤–∞–∫–∞–Ω—Å–∏—é?');">
                <button type="submit" class="button danger">–£–¥–∞–ª–∏—Ç—å</button>
            </form>
        </div>
    </div>
    {% endfor %}
{% else %}
    <div class="empty-state">
        <p style="font-size: 1.2rem;">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –≤–∞–∫–∞–Ω—Å–∏–π</p>
        <p>–°–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ—é –ø–µ—Ä–≤—É—é –≤–∞–∫–∞–Ω—Å–∏—é!</p>
        <a href="{{ url_for('vacancy.create') }}" class="button" style="margin-top: 1rem;">–°–æ–∑–¥–∞—Ç—å –≤–∞–∫–∞–Ω—Å–∏—é</a>
    </div>
{% endif %}
{% endblock %}