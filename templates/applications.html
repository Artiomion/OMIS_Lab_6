{% extends "base.html" %}

{% block title %}–û—Ç–∫–ª–∏–∫–∏ –Ω–∞ –≤–∞–∫–∞–Ω—Å–∏—é{% endblock %}

{% block content %}
<a href="{{ url_for('vacancy.my_vacancies') }}" class="button secondary" style="margin-bottom: 1rem;">‚Üê –ù–∞–∑–∞–¥ –∫ –≤–∞–∫–∞–Ω—Å–∏—è–º</a>

<h2>üì® –û—Ç–∫–ª–∏–∫–∏ –Ω–∞ –≤–∞–∫–∞–Ω—Å–∏—é "{{ vacancy.title }}"</h2>

{% if applications %}
    <p style="margin-bottom: 1rem; color: #6c757d;">–í—Å–µ–≥–æ –æ—Ç–∫–ª–∏–∫–æ–≤: {{ applications|length }}</p>
    
    {% for app in applications %}
    <div class="card">
        <h3>{{ app.applicant.name }}</h3>
        <p><strong>Email:</strong> {{ app.applicant.email }}</p>
        <p><strong>–°—Ç–∞—Ç—É—Å:</strong> <span class="badge {{ app.status }}">{{ app.status }}</span></p>
        <p><strong>–î–∞—Ç–∞ –æ—Ç–∫–ª–∏–∫–∞:</strong> {{ app.created_at.strftime('%d.%m.%Y %H:%M') }}</p>
        
        {% if app.cover_letter %}
        <div style="background: #f8f9fa; padding: 1rem; border-radius: 8px; margin-top: 1rem;">
            <strong>–°–æ–ø—Ä–æ–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ–µ –ø–∏—Å—å–º–æ:</strong>
            <p style="white-space: pre-line; margin-top: 0.5rem;">{{ app.cover_letter }}</p>
        </div>
        {% endif %}
        
        {% if app.applicant.resumes.first() %}
        <div style="margin-top: 1rem;">
            <a href="{{ url_for('resume.view', resume_id=app.applicant.resumes.first().id) }}" class="button">
                –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–µ–∑—é–º–µ
            </a>
        </div>
        {% endif %}
        
        <form method="POST" action="{{ url_for('vacancy.update_application_status', application_id=app.id) }}" style="margin-top: 1rem;">
            <label>–ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å:</label>
            <select name="status" onchange="this.form.submit()" style="padding: 0.5rem; border-radius: 4px; margin-left: 0.5rem;">
                <option value="pending" {% if app.status == 'pending' %}selected{% endif %}>–ù–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏</option>
                <option value="invited" {% if app.status == 'invited' %}selected{% endif %}>–ü—Ä–∏–≥–ª–∞—à–µ–Ω</option>
                <option value="accepted" {% if app.status == 'accepted' %}selected{% endif %}>–ü—Ä–∏–Ω—è—Ç</option>
                <option value="rejected" {% if app.status == 'rejected' %}selected{% endif %}>–û—Ç–∫–ª–æ–Ω–µ–Ω</option>
            </select>
        </form>
    </div>
    {% endfor %}
{% else %}
    <div class="empty-state">
        <p style="font-size: 1.2rem;">–ü–æ–∫–∞ –Ω–µ—Ç –æ—Ç–∫–ª–∏–∫–æ–≤ –Ω–∞ —ç—Ç—É –≤–∞–∫–∞–Ω—Å–∏—é</p>
        <p>–û—Ç–∫–ª–∏–∫–∏ –ø–æ—è–≤—è—Ç—Å—è, –∫–æ–≥–¥–∞ —Å–æ–∏—Å–∫–∞—Ç–µ–ª–∏ –Ω–∞—á–Ω—É—Ç –æ—Ç–∫–ª–∏–∫–∞—Ç—å—Å—è –Ω–∞ –≤–∞—à—É –≤–∞–∫–∞–Ω—Å–∏—é</p>
    </div>
{% endif %}
{% endblock %}