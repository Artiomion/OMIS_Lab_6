{% extends "base.html" %}

{% block title %}–ì–ª–∞–≤–Ω–∞—è - –°–æ–∏—Å–∫–∞—Ç–µ–ª—å{% endblock %}

{% block content %}
<h2>üëã –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {{ current_user.name }}!</h2>

<div class="stats">
    <div class="stat-card">
        <h3>{{ resumes_count }}</h3>
        <p>–ú–æ–∏ —Ä–µ–∑—é–º–µ</p>
    </div>
    <div class="stat-card">
        <h3>{{ applications_count }}</h3>
        <p>–ú–æ–∏ –æ—Ç–∫–ª–∏–∫–∏</p>
    </div>
    <div class="stat-card">
        <h3>{{ recent_vacancies|length }}</h3>
        <p>–ù–æ–≤—ã–µ –≤–∞–∫–∞–Ω—Å–∏–∏</p>
    </div>
</div>

<div class="card">
    <h3>üìä –ú–æ–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –æ—Ç–∫–ª–∏–∫–∏</h3>
    {% if my_applications %}
        <table>
            <thead>
                <tr>
                    <th>–í–∞–∫–∞–Ω—Å–∏—è</th>
                    <th>–ö–æ–º–ø–∞–Ω–∏—è</th>
                    <th>–°—Ç–∞—Ç—É—Å</th>
                    <th>–î–∞—Ç–∞ –æ—Ç–∫–ª–∏–∫–∞</th>
                </tr>
            </thead>
            <tbody>
                {% for app in my_applications %}
                <tr>
                    <td><a href="{{ url_for('vacancy.view', vacancy_id=app.vacancy.id) }}">{{ app.vacancy.title }}</a></td>
                    <td>{{ app.vacancy.employer.company_name or app.vacancy.employer.name }}</td>
                    <td><span class="badge {{ app.status }}">{{ app.status }}</span></td>
                    <td>{{ app.created_at.strftime('%d.%m.%Y') }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <div class="empty-state">
            <p>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –æ—Ç–∫–ª–∏–∫–æ–≤ –Ω–∞ –≤–∞–∫–∞–Ω—Å–∏–∏</p>
            <p><a href="{{ url_for('vacancy.list_vacancies') }}" class="button" style="margin-top: 1rem;">–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤–∞–∫–∞–Ω—Å–∏–∏</a></p>
        </div>
    {% endif %}
</div>

<div class="card">
    <h3>üíº –ù–æ–≤—ã–µ –≤–∞–∫–∞–Ω—Å–∏–∏</h3>
    {% if recent_vacancies %}
        {% for vacancy in recent_vacancies %}
        <div class="card">
            <h4>{{ vacancy.title }}</h4>
            <p style="color: #6c757d;">{{ vacancy.employer.company_name or vacancy.employer.name }}</p>
            {% if vacancy.salary %}<p><strong>–ó–∞—Ä–ø–ª–∞—Ç–∞:</strong> {{ vacancy.salary }} $</p>{% endif %}
            <p>{{ vacancy.description[:200] }}{% if vacancy.description|length > 200 %}...{% endif %}</p>
            <a href="{{ url_for('vacancy.view', vacancy_id=vacancy.id) }}" class="button">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a>
        </div>
        {% endfor %}
        <a href="{{ url_for('vacancy.list_vacancies') }}" class="button secondary">–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ –≤–∞–∫–∞–Ω—Å–∏–∏</a>
    {% else %}
        <div class="empty-state">
            <p>–ü–æ–∫–∞ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≤–∞–∫–∞–Ω—Å–∏–π</p>
        </div>
    {% endif %}
</div>
{% endblock %}