{% extends "base.html" %}

{% block title %}{{ vacancy.title }}{% endblock %}

{% block content %}
<a href="{{ url_for('vacancy.list_vacancies') }}" class="button secondary" style="margin-bottom: 1rem;">‚Üê –ù–∞–∑–∞–¥ –∫ –≤–∞–∫–∞–Ω—Å–∏—è–º</a>

<div class="card">
    <h2>{{ vacancy.title }}</h2>
    <p style="color: #6c757d; font-size: 1.1rem;">
        <strong>{{ vacancy.employer.company_name or vacancy.employer.name }}</strong>
    </p>
    
    {% if vacancy.location %}
    <p>üìç <strong>–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:</strong> {{ vacancy.location }}</p>
    {% endif %}
    
    {% if vacancy.salary %}
    <p>üí∞ <strong>–ó–∞—Ä–ø–ª–∞—Ç–∞:</strong> {{ vacancy.salary }} $</p>
    {% endif %}
    
    <p><span class="badge {{ vacancy.status }}">{{ vacancy.status }}</span></p>
    
    <hr style="margin: 1.5rem 0; border: none; border-top: 1px solid #e0e0e0;">
    
    <h3>–û–ø–∏—Å–∞–Ω–∏–µ –≤–∞–∫–∞–Ω—Å–∏–∏</h3>
    <p style="white-space: pre-line;">{{ vacancy.description }}</p>
    
    {% if vacancy.requirements %}
    <h3 style="margin-top: 1.5rem;">–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è</h3>
    <p style="white-space: pre-line;">{{ vacancy.requirements }}</p>
    {% endif %}
    
    <p style="color: #6c757d; font-size: 0.9rem; margin-top: 2rem;">
        –û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ: {{ vacancy.created_at.strftime('%d.%m.%Y %H:%M') }}
    </p>
    
    {% if current_user.role == 'applicant' %}
        {% if vacancy.status == 'published' %}
            {% if has_applied %}
                <div style="background: #d1ecf1; color: #0c5460; padding: 1rem; border-radius: 8px; margin-top: 1rem;">
                    ‚úÖ –í—ã —É–∂–µ –æ—Ç–∫–ª–∏–∫–Ω—É–ª–∏—Å—å –Ω–∞ —ç—Ç—É –≤–∞–∫–∞–Ω—Å–∏—é
                </div>
            {% else %}
                <h3 style="margin-top: 2rem;">–û—Ç–∫–ª–∏–∫–Ω—É—Ç—å—Å—è –Ω–∞ –≤–∞–∫–∞–Ω—Å–∏—é</h3>
                <form method="POST" action="{{ url_for('vacancy.apply', vacancy_id=vacancy.id) }}">
                    <div class="form-group">
                        <label for="cover_letter">–°–æ–ø—Ä–æ–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ–µ –ø–∏—Å—å–º–æ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
                        <textarea id="cover_letter" name="cover_letter" 
                                  placeholder="–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ, –ø–æ—á–µ–º—É –≤—ã –ø–æ–¥—Ö–æ–¥–∏—Ç–µ –Ω–∞ —ç—Ç—É –ø–æ–∑–∏—Ü–∏—é"></textarea>
                    </div>
                    <button type="submit" class="button success">üì® –û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–∫–ª–∏–∫</button>
                </form>
            {% endif %}
        {% else %}
            <div style="background: #f8d7da; color: #721c24; padding: 1rem; border-radius: 8px; margin-top: 1rem;">
                ‚ö†Ô∏è –≠—Ç–∞ –≤–∞–∫–∞–Ω—Å–∏—è –∑–∞–∫—Ä—ã—Ç–∞ –∏–ª–∏ –µ—â–µ –Ω–µ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–∞
            </div>
        {% endif %}
    {% elif current_user.role == 'employer' and vacancy.employer_id == current_user.id %}
        <div style="margin-top: 2rem;">
            <a href="{{ url_for('vacancy.edit', vacancy_id=vacancy.id) }}" class="button">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
            <a href="{{ url_for('vacancy.applications', vacancy_id=vacancy.id) }}" class="button secondary">–ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –æ—Ç–∫–ª–∏–∫–∏ ({{ vacancy.applications.count() }})</a>
        </div>
    {% endif %}
</div>
{% endblock %}